<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Portal 2B</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
body{min-height:100vh;background:radial-gradient(circle at top,#1a1400,#000);color:#fff}

/* LOGIN */
#loginPage{min-height:100vh;display:flex;justify-content:center;align-items:center}
.box{width:340px;padding:30px;background:#0b0b0b;border-radius:15px;box-shadow:0 0 25px #ffd700}
h2{text-align:center;color:#ffd700;margin-bottom:20px}
input{width:100%;padding:12px;margin-bottom:12px;background:#111;border:1px solid #333;border-radius:8px;color:#fff}
button{width:100%;padding:12px;background:#ffd700;border:none;border-radius:8px;font-weight:bold;cursor:pointer}
.link{text-align:center;font-size:13px}
.link span{color:#ffd700;cursor:pointer}

/* PORTAL */
#portal{display:none}
nav{display:flex;justify-content:space-between;align-items:center;padding:15px;border-bottom:1px solid #333}
.menu{display:flex;gap:10px}
.menu button{background:none;color:#ccc}
.menu button.active{color:#ffd700}

.section{display:none;padding:20px}
.section.active{display:block}

.card{
  border:1px solid #333;
  padding:10px;
  margin:10px 0;
  border-radius:8px;
}
.card small{color:#aaa}
.card button{
  margin-top:5px;
  background:#b91c1c;
  color:#fff;
  border:none;
  padding:5px 10px;
  border-radius:5px;
  cursor:pointer;
}
</style>
</head>

<body>

<!-- LOGIN / CADASTRO -->
<div id="loginPage">
  <div class="box">
    <h2 id="formTitle">LOGIN</h2>

    <input id="user" placeholder="Usu√°rio">
    <input id="pass" type="password" placeholder="Senha">

    <button onclick="login()">Entrar</button>

    <div class="link">
      N√£o tem conta?
      <span onclick="toggle()">Criar conta</span>
    </div>
  </div>
</div>

<!-- PORTAL -->
<div id="portal">
  <nav>
    <h1 style="color:#ffd700">Portal 2B</h1>
    <div class="menu">
      <button class="active" onclick="show('publica',this)">√Årea P√∫blica</button>
      <button onclick="show('meus',this)">Meus Projetos</button>
      <button onclick="show('add',this)">Adicionar</button>
      <button id="btnProfessor" style="display:none"
              onclick="show('professor',this)">Painel do Professor</button>
      <button onclick="logout()">Sair</button>
    </div>
  </nav>

  <!-- √ÅREA P√öBLICA -->
  <div id="publica" class="section active">
    <h2>Projetos da Sala</h2>
    <div id="listaPublica"></div>
  </div>

  <!-- MEUS PROJETOS -->
  <div id="meus" class="section">
    <h2>Meus Projetos</h2>
    <div id="listaMeus"></div>
  </div>

  <!-- ADICIONAR -->
  <div id="add" class="section">
    <h2>Adicionar Projeto</h2>
    <input id="projNome" placeholder="Nome do projeto">
    <input id="projDesc" placeholder="Descri√ß√£o">
    <button onclick="salvarProjeto()">Salvar</button>
  </div>

  <!-- PAINEL DO PROFESSOR -->
  <div id="professor" class="section">
    <h2>Painel do Professor üë®‚Äçüè´</h2>

    <p><strong>Total de alunos:</strong>
      <span id="totalAlunos">0</span></p>

    <p><strong>Total de projetos:</strong>
      <span id="totalProjetos">0</span></p>

    <button onclick="limparProjetos()"
      style="margin-top:15px;background:#b91c1c;color:#fff">
      Apagar TODOS os projetos
    </button>
  </div>
</div>

<script>
const ADMIN = "professor";
const ADMIN_PASS = "1234";

let criandoConta = false;
let usuarioAtual = "";

/* TOGGLE LOGIN / CADASTRO */
function toggle(){
  criandoConta = !criandoConta;
  formTitle.innerText = criandoConta ? "CRIAR CONTA" : "LOGIN";
  document.querySelector("#loginPage button").innerText =
    criandoConta ? "Criar conta" : "Entrar";
  document.querySelector(".link").innerHTML = criandoConta
    ? 'J√° tem conta? <span onclick="toggle()">Fazer login</span>'
    : 'N√£o tem conta? <span onclick="toggle()">Criar conta</span>';
}

/* LOGIN / CADASTRO */
function login(){
  let u = user.value;
  let p = pass.value;
  if(!u || !p) return alert("Preencha tudo");

  let contas = JSON.parse(localStorage.getItem("contas")) || {};

  if(criandoConta){
    if(contas[u] || u === ADMIN) return alert("Usu√°rio j√° existe");
    contas[u] = p;
    localStorage.setItem("contas", JSON.stringify(contas));
    alert("Conta criada!");
    toggle();
    return;
  }

  if(u === ADMIN && p === ADMIN_PASS){
    usuarioAtual = ADMIN;
  }else{
    if(contas[u] !== p) return alert("Login inv√°lido");
    usuarioAtual = u;
  }

  localStorage.setItem("logado", usuarioAtual);
  entrar();
}

/* ENTRAR */
function entrar(){
  loginPage.style.display="none";
  portal.style.display="block";
  carregarPublica();
  carregarMeus();

  if(usuarioAtual === ADMIN){
    document.getElementById("btnProfessor").style.display = "inline-block";
    carregarPainelProfessor();
  }
}

/* SALVAR PROJETO */
function salvarProjeto(){
  let nome = projNome.value;
  let desc = projDesc.value;
  if(!nome || !desc) return alert("Preencha tudo");

  let projetos = JSON.parse(localStorage.getItem("projetos")) || {};
  if(!projetos[usuarioAtual]) projetos[usuarioAtual] = [];

  projetos[usuarioAtual].push({nome, desc});
  localStorage.setItem("projetos", JSON.stringify(projetos));

  projNome.value=""; projDesc.value="";
  carregarPublica();
  carregarMeus();
}

/* MEUS PROJETOS */
function carregarMeus(){
  let projetos = JSON.parse(localStorage.getItem("projetos")) || {};
  listaMeus.innerHTML="";

  (projetos[usuarioAtual]||[]).forEach((p,i)=>{
    listaMeus.innerHTML+=`
      <div class="card">
        <strong>${p.nome}</strong>
        <p>${p.desc}</p>
        <button onclick="excluir('${usuarioAtual}',${i})">Excluir</button>
      </div>
    `;
  });
}

/* √ÅREA P√öBLICA */
function carregarPublica(){
  let projetos = JSON.parse(localStorage.getItem("projetos")) || {};
  listaPublica.innerHTML="";

  for(let aluno in projetos){
    projetos[aluno].forEach((p,i)=>{
      listaPublica.innerHTML+=`
        <div class="card">
          <strong>${p.nome}</strong>
          <p>${p.desc}</p>
          <small>Aluno: ${aluno}</small>
          ${usuarioAtual===ADMIN
            ? `<button onclick="excluir('${aluno}',${i})">Excluir</button>`
            : ""}
        </div>
      `;
    });
  }
}

/* EXCLUIR */
function excluir(dono,index){
  let projetos = JSON.parse(localStorage.getItem("projetos"));
  projetos[dono].splice(index,1);
  localStorage.setItem("projetos", JSON.stringify(projetos));
  carregarPublica();
  carregarMeus();
  carregarPainelProfessor();
}

/* PAINEL DO PROFESSOR */
function carregarPainelProfessor(){
  let contas = JSON.parse(localStorage.getItem("contas")) || {};
  let projetos = JSON.parse(localStorage.getItem("projetos")) || {};

  totalAlunos.innerText = Object.keys(contas).length;

  let total = 0;
  for(let u in projetos) total += projetos[u].length;
  totalProjetos.innerText = total;
}

/* LIMPAR PROJETOS */
function limparProjetos(){
  if(!confirm("Apagar TODOS os projetos?")) return;
  localStorage.removeItem("projetos");
  carregarPublica();
  carregarMeus();
  carregarPainelProfessor();
}

/* ABAS */
function show(id,btn){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll(".menu button").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
}

/* LOGOUT */
function logout(){
  localStorage.removeItem("logado");
  location.reload();
}

/* AUTO LOGIN */
if(localStorage.getItem("logado")){
  usuarioAtual = localStorage.getItem("logado");
  entrar();
}
</script>

</body>
</html>
